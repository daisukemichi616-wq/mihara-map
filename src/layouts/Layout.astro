---
const { title, description, image } = Astro.props;
const siteTitle = "三原市まち歩き - PHOTO MAP";
const fullTitle = title ? `${title} | ${siteTitle}` : siteTitle;
const desc = description || "広島県三原市の魅力を再発見するフォトマッププロジェクト。";
const img = image || "https://i.postimg.cc/Dy2sThhC/IMG-9586.jpg";
---
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="referrer" content="no-referrer">

    <title>{fullTitle}</title>
    <meta name="description" content={desc}>
    <meta property="og:title" content={fullTitle}>
    <meta property="og:description" content={desc}>
    <meta property="og:image" content={img}>
    <meta property="og:type" content="website">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&family=Noto+Serif+JP:wght@700;900&family=DotGothic16&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />

    <style is:inline>
        :root {
            --palette-blue: #004098;
            --palette-blue-light: #e1f5fe;
            --palette-sky: #f0f7ff;
            --palette-gold: #f5d76e;
            --text-main: #1a1a1a;
            --text-sub: #4b5563;
            --border-soft: #e2e8f0;
        }
        html { scroll-behavior: smooth; }
        *:not(i):not(svg):not(polyline):not(rect):not(path):not(circle):not(line) {
            font-family: 'Zen Maru Gothic', sans-serif !important;
            font-weight: 500;
        }
        .serif-custom { font-family: 'Noto Serif JP', serif !important; font-weight: 700 !important; }
        body { color: var(--text-main); background-color: #fff; margin: 0; padding-top: 60px; overflow-x: hidden; line-height: 1.8; transition: background-color 0.5s ease; }

        .fixed-nav {
            position: fixed; top: 0; left: 0; width: 100%; height: 60px;
            background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border-soft); z-index: 9999;
            display: flex; justify-content: space-between; align-items: center; padding: 0 15px;
        }
        .header-logo { font-weight: 700 !important; font-size: 0.8rem; color: var(--palette-blue); letter-spacing: 0.05em; }
        .nav-links-wrap { display: flex; gap: 10px; align-items: center; }
        .nav-simple-link { font-size: 10px; font-weight: 700 !important; color: #9ca3af; text-decoration: none; white-space: nowrap; cursor: pointer; }
        .nav-simple-link:hover { color: var(--palette-blue); }

        #rpg-toggle-btn {
            background: var(--palette-blue); color: white; padding: 6px 14px; border-radius: 20px;
            font-size: 10px; font-weight: 700; display: flex; align-items: center; gap: 6px;
        }

        .section-wrap { padding: 100px 24px; scroll-margin-top: 60px; transition: background-color 0.5s ease; }
        .inner-limit { max-width: 750px; margin: 0 auto; text-align: center; }
        .section-tag-label { font-size: 0.8rem; font-weight: 700 !important; color: var(--palette-blue); letter-spacing: 0.25em; margin-bottom: 40px; display: block; text-transform: uppercase; }

        .card-frame { background: white; border-radius: 12px; padding: 40px 25px; margin-bottom: 30px; text-align: left; border: 1px solid var(--border-soft); box-shadow: 0 10px 30px rgba(0,64,152,0.03); }
        .card-frame h4 { font-weight: 700 !important; color: var(--palette-blue); border-left: 5px solid var(--palette-blue); padding-left: 15px; margin-bottom: 12px; }

        .sticky-tab-bar { position: sticky; top: 60px; background: rgba(255,255,255,0.98); z-index: 900; border-bottom: 2px solid var(--palette-blue); overflow-x: auto; white-space: nowrap; }
        .tab-flex { display: flex; justify-content: center; }
        .tab-item { padding: 22px 18px; font-size: 0.85rem; font-weight: 700 !important; color: #9ca3af; cursor: pointer; border-bottom: 4px solid transparent; }
        .tab-item.active { color: var(--palette-blue); border-bottom-color: var(--palette-blue); }

        .photo-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1px; background: var(--border-soft); }
        @media (min-width: 768px) { .photo-grid { grid-template-columns: repeat(4, 1fr); } }
        .photo-item { position: relative; aspect-ratio: 1/1; background: #f3f4f6; overflow: hidden; display: block; }
        .photo-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.8s; }
        
        /* ★浮かび上がる演出のCSS★ */
        .photo-overlay {
            position: absolute; inset: 0; 
            background: linear-gradient(to top, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0) 80%);
            opacity: 0; transition: opacity 0.6s;
            display: flex; flex-direction: column; justify-content: flex-end; padding: 10px;
        }
        .photo-overlay span {
            transform: translateY(15px); opacity: 0;
            transition: transform 0.6s cubic-bezier(0.215, 0.61, 0.355, 1), opacity 0.6s ease;
        }
        .photo-item:hover .photo-overlay { opacity: 1; }
        .photo-item:hover .photo-overlay span { transform: translateY(0); opacity: 1; }
        .photo-item:hover img { transform: scale(1.1); }

        /* RPG Mode */
        body.rpg-mode { background-color: #000 !important; color: #fff !important; font-family: 'DotGothic16', sans-serif !important; }
        body.rpg-mode *:not(i) { font-family: 'DotGothic16', sans-serif !important; }
        body.rpg-mode .card-frame, body.rpg-mode .fixed-nav, body.rpg-mode .sticky-tab-bar, body.rpg-mode .section-wrap:nth-child(even) {
            background: #00008b !important; border: 3px double #fff !important; border-radius: 4px !important; color: #fff !important;
        }
        body.rpg-mode .text-blue-900, body.rpg-mode .section-tag-label { color: #f5d76e !important; }
        body.rpg-mode #sub-map { color: #1a1a1a !important; text-shadow: none; }
    </style>
</head>
<body id="top">
    <slot />
    <script is:inline>
        if (localStorage.getItem('rpg-mode') === 'true') {
            document.body.classList.add('rpg-mode');
        }
    </script>
</body>
</html>